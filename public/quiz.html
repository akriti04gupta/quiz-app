<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KRAK THE CODE! - Quiz</title>

<!-- Inter Font -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@600&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;}

html,body{
    width:100%;
    height:100%;
    background:#000;
    overflow:hidden;
    display:flex;
    justify-content:center;
    align-items:center;
    font-family:'Inter',sans-serif;
}

/* CANVAS */
.canvas-wrapper{
    position:relative;
    width:387px;
    height:688px;
    transform-origin:center center;
}

.canvas{
    position:absolute;
    width:387px;
    height:688px;
    background:url("/assets/second/background.png") no-repeat center;
    background-size:cover;
}

/* VECTOR TOP LEFT */
.vector-bg{
    position:absolute;
    top:18px;
    left:18px;
    width:36px;
}

.vector-icon{
    position:absolute;
    top:26px;
    left:27px;
    width:20px;
}

/* TITLE */
.title{
    position:absolute;
    top:85px;
    left:30px;
    right:30px;
    font-size:32px;
    font-weight:600;
    line-height:1.1;
    color:#fff;
}

.title span{color:#ff3b00;}

.subtitle{
    position:absolute;
    top:180px;
    left:30px;
    right:30px;
    font-size:13px;
    color:#d0d0d0;
}

/* INPUT */
.input-section{
    position:absolute;
    top:230px;
    left:30px;
    right:30px;
}

.input-label{
    font-size:12px;
    color:#e0e0e0;
    margin-bottom:6px;
    display:block;
}

.input-field{
    width:85%;
    padding:12px;
    border-radius:6px;
    border:none;
    background:#ffffff;
    font-size:13px;
    color:#000;
}

/* BEGIN BUTTON */
.begin-btn{
    position:absolute;
    top:305px;
    left:35%;
    transform:translateX(-50%);
    width:200px;
    padding:12px 0;
    border-radius:999px;
    border:none;
    background:#fff;
    font-weight:600;
    font-size:14px;
    cursor:pointer;
    transition:all 0.25s ease;
    box-shadow:0 4px 12px rgba(255,255,255,0.1);
}

.begin-btn:hover{
    background:#ff3b00;
    color:#fff;
    transform:translateX(-50%) translateY(-2px);
    box-shadow:0 6px 20px rgba(255,59,0,0.4);
}

.begin-btn:active{
    transform:translateX(-50%) translateY(0);
}

/* BADGE IMAGES */
.today-badge{
    position:absolute;
    top:380px;
    left:30px;
    width:130px;
}
.code-title{
    position:absolute;
    top:110px;
    left:30px;
    width:369px;
}

.alltime-badge{
    position:absolute;
    top:520px;
    left:30px;
    width:110px;
}

/* STATS TEXT */
.stats-container{
    position:absolute;
    left:30px;
    right:30px;
    display:flex;
    gap:12px;
    flex-direction:row;
}

.stats-container.today-stats{ top:430px; }
.stats-container.alltime-stats{ top:570px; }

.stat-item{
    flex:1;
    background:rgba(0,0,0,0.5);
    padding:12px;
    border-radius:8px;
}

.stat-label{
    font-size:12px;
    color:#ffffff;
    margin-bottom:4px;
}

.stat-value{
    font-size:22px;
    font-weight:600;
    color:#ff3b00;
    line-height:1.1;
    font-family:'Inter',sans-serif;
}
.stat-name{
    font-size:12px;
    color:#d0d0d0;
    margin-top:4px;
}

.hidden{display:none!important;}
</style>
</head>

<body>

<div class="canvas-wrapper" id="wrapper">
    <div class="canvas"></div>

    <!-- VECTOR DECORATION -->
    <div class="back-wrapper" onclick="location.href='index.html'">
    <img src="/assets/second/vector_background.png" class="vector-bg">
    <img src="/assets/second/vector.png" class="vector-icon">
</div>


    <!-- START SCREEN -->
    <div id="startScreen">

        <img src="/assets/second/code.png" class="code-title">


        

        <div class="input-section">
            <label class="input-label">Full Name</label>
            <input id="playerName" class="input-field" placeholder="Enter your full name">
        </div>

        <!-- BEGIN BUTTON -->
        <button class="begin-btn" id="startBtn">Let's Begin</button>

        <!-- TODAY -->
        <img src="/assets/second/best.png" class="today-badge">

        <div class="stats-container today-stats">
            <div class="stat-item">
                <div class="stat-label">Top score:</div>
                <div id="todayTopScore" class="stat-value">0 Coins</div>
                <div id="todayTopName" class="stat-name">-</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Fastest Completion Time:</div>
                <div id="todayFastestTime" class="stat-value">00:00</div>
            </div>
        </div>

        <!-- ALL TIME -->
        <img src="/assets/second/best2.png" class="alltime-badge">

        <div class="stats-container alltime-stats">
            <div class="stat-item">
                <div class="stat-label">Top score:</div>
                <div id="allTimeTopScore" class="stat-value">0 Coins</div>
                <div id="allTimeTopName" class="stat-name">-</div>
            </div>
            <div class="stat-item">
                <div class="stat-label">Fastest Completion Time:</div>
                <div id="allTimeFastestTime" class="stat-value">00:00</div>
            </div>
        </div>

    </div>
</div>

<script>
function scaleCanvas(){
    const wrapper=document.getElementById("wrapper");
    const scale=Math.min(window.innerWidth/387,window.innerHeight/688);
    wrapper.style.transform=`scale(${scale})`;
}
scaleCanvas();
window.addEventListener("resize",scaleCanvas);

document.getElementById("startBtn").onclick=function(){
    const name=document.getElementById("playerName").value.trim();
    if(!name){alert("Enter your name");return;}
    localStorage.setItem("playerName", name);
    window.location.href="actual_quiz.html";
};

document.getElementById("playerName").addEventListener("keypress", function(e){
    if(e.key === "Enter"){
        document.getElementById("startBtn").click();
    }
});

async function loadLeaderboard(){
    try{
        const res=await fetch('http://localhost:3000/api/quiz/leaderboard');
        const data=await res.json();

        if(data.today?.[0]){
            const todayCoins = data.today[0].points ?? (data.today[0].score * 10);
            document.getElementById('todayTopScore').textContent=todayCoins+" Coins";
            document.getElementById('todayFastestTime').textContent=formatTime(data.today[0].timeTaken||0);
            document.getElementById('todayTopName').textContent=data.today[0].playerName || 'Anonymous';
        }

        if(data.allTime?.[0]){
            const allTimeCoins = data.allTime[0].points ?? (data.allTime[0].score * 10);
            document.getElementById('allTimeTopScore').textContent=allTimeCoins+" Coins";
            document.getElementById('allTimeFastestTime').textContent=formatTime(data.allTime[0].timeTaken||0);
            document.getElementById('allTimeTopName').textContent=data.allTime[0].playerName || 'Anonymous';
        }
    }catch(e){}
}

function formatTime(s){
    const n = parseInt(s);
    const m=Math.floor(n/60);
    const sec=n%60;
    return m.toString().padStart(2,'0')+":"+sec.toString().padStart(2,'0');
}

loadLeaderboard();
</script>

</body>
</html>
